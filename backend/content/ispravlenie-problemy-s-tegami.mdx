---
title: "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ–≥–∞–º–∏"
description: "Expected string, received array"
date: "2025-07-23T11:07:34.062Z"
author: "PXLR Teme"
tags: ["pxlr"]
category: "—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞"
draft: false
---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ç–µ–≥–∞–º–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
```
Expected string, received array
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ç–∏–ø–æ–≤ –º–µ–∂–¥—É zod —Å—Ö–µ–º–æ–π –∏ react-hook-form:

1. **zod —Å—Ö–µ–º–∞** —Å `transform()` –æ–∂–∏–¥–∞–ª–∞ `string` –Ω–∞ –≤—Ö–æ–¥–µ, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ `string[]` –Ω–∞ –≤—ã—Ö–æ–¥–µ
2. **react-hook-form** –æ–∂–∏–¥–∞–ª, —á—Ç–æ `defaultValues` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤—Ö–æ–¥–Ω–æ–º—É —Ç–∏–ø—É —Å—Ö–µ–º—ã  
3. **–ü–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –º–∞—Å—Å–∏–≤—ã** –≤ `defaultValues`, –Ω–æ —Å—Ö–µ–º–∞ –æ–∂–∏–¥–∞–ª–∞ —Å—Ç—Ä–æ–∫–∏

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥

```typescript
// ‚ùå –ü—Ä–æ–±–ª–µ–º–Ω–∞—è —Å—Ö–µ–º–∞
tags: z
  .string()
  .optional()
  .transform((val) => val ? val.split(',').map(tag => tag.trim()).filter(Boolean) : []),

// ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ç–∏–ø–æ–≤
const defaultValues = {
  tags: post.tags || [], // –ú–∞—Å—Å–∏–≤, –Ω–æ —Å—Ö–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç —Å—Ç—Ä–æ–∫—É!
};
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –†–∞–∑–¥–µ–ª–∏–ª–∏ —Ç–∏–ø—ã –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```typescript
// ‚úÖ –°—Ö–µ–º–∞ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã (–±–µ–∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏)
export const postFormInputSchema = z.object({
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
  tags: z.array(z.string()).optional(),
});

// ‚úÖ –°—Ö–µ–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π)
export const postFormSchema = postFormInputSchema.transform((data) => ({
  ...data,
  tags: data.tags || []
}));

// ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã
export type PostFormInput = z.infer<typeof postFormInputSchema>;  // –î–ª—è —Ñ–æ—Ä–º—ã
export type PostFormData = z.infer<typeof postFormSchema>;        // –î–ª—è API
```

### 2. –û–±–Ω–æ–≤–∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–µ–≥–æ–≤ –≤ —Ñ–æ—Ä–º–µ

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–≥–æ–≤ –≤ Input
<Input 
  placeholder="—Ç–µ–≥1, —Ç–µ–≥2, —Ç–µ–≥3"
  value={Array.isArray(field.value) ? field.value.join(', ') : ''}
  onChange={(e) => {
    const tags = e.target.value
      .split(',')
      .map(tag => tag.trim())
      .filter(Boolean);
    field.onChange(tags);
  }}
/>
```

### 3. –ò—Å–ø—Ä–∞–≤–∏–ª–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—é –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```typescript
// ‚úÖ PostForm.tsx
interface PostFormProps {
  defaultValues?: Partial<PostFormInput>;  // –í—Ö–æ–¥–Ω–æ–π —Ç–∏–ø
  onSubmit: (data: PostFormInput) => void; // –í—Ö–æ–¥–Ω–æ–π —Ç–∏–ø
}

// ‚úÖ usePosts.ts
const useCreatePost = () => {
  return useMutation({
    mutationFn: async (data: PostFormInput) => { // –í—Ö–æ–¥–Ω–æ–π —Ç–∏–ø
      const mdxContent = generateMDXContent(
        data.title,
        data.description,
        data.content,
        {
          tags: data.tags || [], // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
        }
      );
    }
  });
};
```

## üìÅ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ `admin/src/lib/validations.ts` - –Ω–æ–≤—ã–µ —Å—Ö–µ–º—ã –∏ —Ç–∏–ø—ã
- ‚úÖ `admin/src/components/forms/PostForm.tsx` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–≥–æ–≤
- ‚úÖ `admin/src/hooks/usePosts.ts` - —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Ö—É–∫–æ–≤
- ‚úÖ `admin/src/routes/PostCreate.tsx` - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- ‚úÖ `admin/src/routes/PostEdit.tsx` - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### –ù–æ–≤—ã–µ —Ç–∏–ø—ã
```typescript
PostFormInput   // –î–ª—è react-hook-form (—Ç–µ–≥–∏ –∫–∞–∫ string[])
PostFormData    // –î–ª—è API (—Ç–µ–≥–∏ –∫–∞–∫ string[])
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚ùå Error: Expected string, received array
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```bash
# ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ç–µ–≥–∞–º–∏
curl -X POST http://localhost:3333/api/posts \
  -d '{"filename": "test.mdx", "content": "tags: [\"tag1\", \"tag2\"]"}'

# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç
{
  "title": "Test Post",
  "tags": ["tag1", "tag2"]  // –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –º–∞—Å—Å–∏–≤
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤** —Å —Ç–µ–≥–∞–º–∏ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- ‚úÖ **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ–≥–∞–º–∏
- ‚úÖ **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–≥–æ–≤** –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –≤ —Ñ–æ—Ä–º–µ
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–≥–æ–≤** –∫–∞–∫ –º–∞—Å—Å–∏–≤ –≤ API
- ‚úÖ **TypeScript –≤–∞–ª–∏–¥–∞—Ü–∏—è** –±–µ–∑ –æ—à–∏–±–æ–∫

### üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –í—Å–µ –ø–æ—Å—Ç—ã —Å —Ç–µ–≥–∞–º–∏
curl http://localhost:3333/api/posts | jq '.posts[].tags'

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
["—Ç–µ—Å—Ç", "api"]
["—Ç–µ—Å—Ç", "–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", "—Ç–µ–≥–∏", "array", "string"]
["–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ", "ui", "—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"] 
["welcome", "cms", "getting-started"]
```

## üí° –£—Ä–æ–∫–∏

### üìö –ß—Ç–æ –∏–∑—É—á–∏–ª–∏
1. **zod transform** —Å–æ–∑–¥–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞
2. **react-hook-form** —Ç—Ä–µ–±—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–æ–≤ –≤ `defaultValues`
3. **TypeScript —Å—Ç—Ä–æ–≥–æ—Å—Ç—å** –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
4. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤** —É–ª—É—á—à–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

### üõ†Ô∏è –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö `transform` –≤ zod —Å—Ö–µ–º–∞—Ö –¥–ª—è —Ñ–æ—Ä–º
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ç–∏–ø–∏–∑–∞—Ü–∏—é —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–æ–≤

## üöÄ –°—Ç–∞—Ç—É—Å

**‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û** - –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–µ–≥–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!

- üéØ **4 —Ç–µ—Å—Ç–∞ –ø–æ—Å—Ç–∞** —Å —Ç–µ–≥–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- üîß **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã  
- üìù **–§–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç** –±–µ–∑ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- üõ°Ô∏è **TypeScript** –Ω–µ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–æ–∫ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É! üéâ 